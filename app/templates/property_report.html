<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Property Intelligence Report</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        :root {
            --primary: #1a56db;
            --primary-light: #3b82f6;
            --secondary: #6b7280;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #111827;
            --light: #f9fafb;
            --border: #e5e7eb;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            font-size: 10pt;
            line-height: 1.5;
            color: var(--dark);
            background: white;
        }

        /* Page Setup */
        @page {
            size: letter;
            margin: 0.75in;
            @bottom-center {
                content: "Page " counter(page) " of " counter(pages);
                font-size: 9pt;
                color: #6b7280;
            }
        }

        @page :first {
            margin-top: 0;
            @bottom-center { content: none; }
        }

        /* Cover Page */
        .cover {
            page-break-after: always;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .cover-header {
            background: linear-gradient(135deg, var(--primary) 0%, #1e3a8a 100%);
            color: white;
            padding: 40px;
            margin: -0.75in -0.75in 0 -0.75in;
        }

        .brand-name {
            font-size: 14pt;
            font-weight: 500;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .cover-title {
            font-size: 28pt;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .cover-subtitle {
            font-size: 12pt;
            opacity: 0.85;
        }

        .cover-image {
            flex: 1;
            background: var(--light);
            margin: 30px 0;
            border-radius: 12px;
            overflow: hidden;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .cover-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .cover-image .placeholder {
            color: var(--secondary);
            font-size: 14pt;
        }

        .cover-details {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: auto;
            padding-top: 30px;
            border-top: 1px solid var(--border);
        }

        .cover-detail-item {
            text-align: center;
        }

        .cover-detail-label {
            font-size: 9pt;
            color: var(--secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .cover-detail-value {
            font-size: 12pt;
            font-weight: 600;
            color: var(--dark);
        }

        /* Section Styles */
        .section {
            margin-bottom: 30px;
            page-break-inside: avoid;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
        }

        .section-icon {
            width: 28px;
            height: 28px;
            background: var(--primary);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 12pt;
        }

        .section-title {
            font-size: 14pt;
            font-weight: 600;
            color: var(--dark);
        }

        /* Executive Summary */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        .summary-card {
            background: var(--light);
            border-radius: 8px;
            padding: 16px;
            border: 1px solid var(--border);
        }

        .summary-card-title {
            font-size: 9pt;
            color: var(--secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .summary-card-value {
            font-size: 18pt;
            font-weight: 700;
            color: var(--dark);
        }

        .summary-card-value.success { color: var(--success); }
        .summary-card-value.warning { color: var(--warning); }
        .summary-card-value.danger { color: var(--danger); }

        /* Risk Scores */
        .risk-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .risk-item {
            text-align: center;
            padding: 15px;
            background: var(--light);
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .risk-label {
            font-size: 9pt;
            color: var(--secondary);
            margin-bottom: 8px;
        }

        .risk-score {
            font-size: 24pt;
            font-weight: 700;
        }

        .risk-score.low { color: var(--success); }
        .risk-score.medium { color: var(--warning); }
        .risk-score.high { color: var(--danger); }

        .risk-bar {
            height: 6px;
            background: var(--border);
            border-radius: 3px;
            margin-top: 8px;
            overflow: hidden;
        }

        .risk-bar-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.3s;
        }

        .risk-bar-fill.low { background: var(--success); }
        .risk-bar-fill.medium { background: var(--warning); }
        .risk-bar-fill.high { background: var(--danger); }

        /* Property Facts */
        .facts-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }

        .fact-item {
            text-align: center;
            padding: 20px 10px;
            background: var(--light);
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .fact-value {
            font-size: 20pt;
            font-weight: 700;
            color: var(--primary);
        }

        .fact-label {
            font-size: 9pt;
            color: var(--secondary);
            margin-top: 4px;
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 9pt;
        }

        th {
            background: var(--light);
            padding: 10px 12px;
            text-align: left;
            font-weight: 600;
            color: var(--dark);
            border-bottom: 2px solid var(--border);
        }

        td {
            padding: 10px 12px;
            border-bottom: 1px solid var(--border);
            color: var(--dark);
        }

        tr:nth-child(even) {
            background: var(--light);
        }

        /* Info Box */
        .info-box {
            background: #eff6ff;
            border: 1px solid #bfdbfe;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .info-box.warning {
            background: #fffbeb;
            border-color: #fcd34d;
        }

        .info-box.danger {
            background: #fef2f2;
            border-color: #fca5a5;
        }

        .info-box-title {
            font-weight: 600;
            margin-bottom: 5px;
        }

        /* Checklist */
        .checklist {
            list-style: none;
        }

        .checklist li {
            padding: 8px 0;
            padding-left: 28px;
            position: relative;
            border-bottom: 1px solid var(--border);
        }

        .checklist li::before {
            content: "";
            position: absolute;
            left: 0;
            top: 10px;
            width: 16px;
            height: 16px;
            border: 2px solid var(--primary);
            border-radius: 4px;
        }

        /* Comps Table */
        .comps-table {
            font-size: 8pt;
        }

        .comps-table th,
        .comps-table td {
            padding: 8px;
        }

        /* Footer */
        .report-footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
            text-align: center;
            color: var(--secondary);
            font-size: 9pt;
        }

        .disclaimer {
            font-size: 8pt;
            color: var(--secondary);
            margin-top: 20px;
            padding: 15px;
            background: var(--light);
            border-radius: 8px;
        }

        /* Page Breaks */
        .page-break {
            page-break-after: always;
        }

        /* Utilities */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .mt-20 { margin-top: 20px; }
        .mb-20 { margin-bottom: 20px; }
        .font-bold { font-weight: 600; }
    </style>
</head>
<body>
    <!-- Cover Page -->
    <div class="cover">
        <div class="cover-header">
            <div class="brand-name">{{ brand_name }}</div>
            <div class="cover-title">Property Intelligence Report</div>
            <div class="cover-subtitle">Comprehensive Due Diligence Analysis</div>
        </div>

        <div class="cover-image">
            {% if property_image %}
            <img src="{{ property_image }}" alt="Property">
            {% else %}
            <div class="placeholder">Property Image</div>
            {% endif %}
        </div>

        <div style="text-align: center; margin: 20px 0;">
            <div style="font-size: 18pt; font-weight: 700; color: var(--dark);">
                {{ address }}
            </div>
            <div style="font-size: 12pt; color: var(--secondary); margin-top: 5px;">
                {{ city }}, {{ state }} {{ zip_code }}
            </div>
        </div>

        <div class="cover-details">
            <div class="cover-detail-item">
                <div class="cover-detail-label">Report Date</div>
                <div class="cover-detail-value">{{ report_date }}</div>
            </div>
            <div class="cover-detail-item">
                <div class="cover-detail-label">Intended Use</div>
                <div class="cover-detail-value">{{ intended_use }}</div>
            </div>
            <div class="cover-detail-item">
                <div class="cover-detail-label">Value Estimate</div>
                <div class="cover-detail-value">{{ value_range }}</div>
            </div>
        </div>
    </div>

    <!-- Executive Summary -->
    <div class="section">
        <div class="section-header">
            <div class="section-icon">1</div>
            <div class="section-title">Executive Summary</div>
        </div>

        <div class="summary-grid">
            <div class="summary-card">
                <div class="summary-card-title">Estimated Value</div>
                <div class="summary-card-value">{{ value_range }}</div>
            </div>
            <div class="summary-card">
                <div class="summary-card-title">Current Owner</div>
                <div class="summary-card-value" style="font-size: 14pt;">{{ current_owner or 'Unknown' }}</div>
            </div>
            <div class="summary-card">
                <div class="summary-card-title">Assessed Value</div>
                <div class="summary-card-value">{{ assessed_value_formatted }}</div>
            </div>
            <div class="summary-card">
                <div class="summary-card-title">Zoning</div>
                <div class="summary-card-value" style="font-size: 14pt;">{{ zoning or 'Unknown' }}</div>
            </div>
        </div>

        <h4 style="margin-bottom: 15px; color: var(--dark);">Risk Assessment</h4>
        <div class="risk-grid">
            {% for risk in risks %}
            <div class="risk-item">
                <div class="risk-label">{{ risk.label }}</div>
                <div class="risk-score {{ risk.level }}">{{ risk.score }}/10</div>
                <div class="risk-bar">
                    <div class="risk-bar-fill {{ risk.level }}" style="width: {{ risk.score * 10 }}%;"></div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Property Facts -->
    <div class="section">
        <div class="section-header">
            <div class="section-icon">2</div>
            <div class="section-title">Property Facts</div>
        </div>

        <div class="facts-grid">
            <div class="fact-item">
                <div class="fact-value">{{ beds or '-' }}</div>
                <div class="fact-label">Bedrooms</div>
            </div>
            <div class="fact-item">
                <div class="fact-value">{{ baths or '-' }}</div>
                <div class="fact-label">Bathrooms</div>
            </div>
            <div class="fact-item">
                <div class="fact-value">{{ sqft_formatted or '-' }}</div>
                <div class="fact-label">Sq Ft</div>
            </div>
            <div class="fact-item">
                <div class="fact-value">{{ year_built or '-' }}</div>
                <div class="fact-label">Year Built</div>
            </div>
        </div>

        {% if property_facts %}
        <table class="mt-20">
            <tr>
                <th>Feature</th>
                <th>Details</th>
            </tr>
            {% for fact in property_facts %}
            <tr>
                <td class="font-bold">{{ fact.label }}</td>
                <td>{{ fact.value }}</td>
            </tr>
            {% endfor %}
        </table>
        {% endif %}
    </div>

    <div class="page-break"></div>

    <!-- Ownership Timeline -->
    <div class="section">
        <div class="section-header">
            <div class="section-icon">3</div>
            <div class="section-title">Ownership & Title Timeline</div>
        </div>

        {% if ownership_timeline %}
        <table>
            <tr>
                <th>Date</th>
                <th>Grantor</th>
                <th>Grantee</th>
                <th>Type</th>
                <th>Consideration</th>
            </tr>
            {% for transfer in ownership_timeline %}
            <tr>
                <td>{{ transfer.date }}</td>
                <td>{{ transfer.grantor }}</td>
                <td>{{ transfer.grantee }}</td>
                <td>{{ transfer.type }}</td>
                <td>{{ transfer.consideration }}</td>
            </tr>
            {% endfor %}
        </table>
        {% else %}
        <div class="info-box">
            <div class="info-box-title">Title History</div>
            <p>Full title history requires county clerk records search. See Next Steps for details.</p>
        </div>
        {% endif %}

        {% if title_flags %}
        <div class="info-box warning mt-20">
            <div class="info-box-title">Title Red Flags</div>
            <ul>
                {% for flag in title_flags %}
                <li>{{ flag }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
    </div>

    <!-- Taxes & Assessments -->
    <div class="section">
        <div class="section-header">
            <div class="section-icon">4</div>
            <div class="section-title">Taxes & Assessments</div>
        </div>

        {% if tax_history %}
        <table>
            <tr>
                <th>Year</th>
                <th>Assessed Value</th>
                <th>Tax Billed</th>
                <th>Status</th>
            </tr>
            {% for tax in tax_history %}
            <tr>
                <td>{{ tax.year }}</td>
                <td>{{ tax.assessed }}</td>
                <td>{{ tax.billed }}</td>
                <td>{{ tax.status }}</td>
            </tr>
            {% endfor %}
        </table>
        {% else %}
        <div class="info-box">
            <p>Tax history data requires municipal tax assessor records. Current assessed value: {{ assessed_value_formatted }}</p>
        </div>
        {% endif %}
    </div>

    <!-- Zoning & Permits -->
    <div class="section">
        <div class="section-header">
            <div class="section-icon">5</div>
            <div class="section-title">Zoning & Permits</div>
        </div>

        <div class="summary-grid">
            <div class="summary-card">
                <div class="summary-card-title">Zoning Classification</div>
                <div class="summary-card-value" style="font-size: 16pt;">{{ zoning or 'Unknown' }}</div>
            </div>
            <div class="summary-card">
                <div class="summary-card-title">Zoning Summary</div>
                <div style="font-size: 10pt; color: var(--secondary);">{{ zoning_summary or 'Contact municipal zoning office for details.' }}</div>
            </div>
        </div>

        {% if permits %}
        <h4 class="mt-20 mb-20">Permit History</h4>
        <table>
            <tr>
                <th>Date</th>
                <th>Type</th>
                <th>Description</th>
                <th>Status</th>
            </tr>
            {% for permit in permits %}
            <tr>
                <td>{{ permit.date }}</td>
                <td>{{ permit.type }}</td>
                <td>{{ permit.description }}</td>
                <td>{{ permit.status }}</td>
            </tr>
            {% endfor %}
        </table>
        {% endif %}
    </div>

    <div class="page-break"></div>

    <!-- Market Comps -->
    <div class="section">
        <div class="section-header">
            <div class="section-icon">6</div>
            <div class="section-title">Market Comps & Valuation</div>
        </div>

        <div class="summary-grid">
            <div class="summary-card">
                <div class="summary-card-title">Value Estimate</div>
                <div class="summary-card-value success">{{ value_range }}</div>
            </div>
            <div class="summary-card">
                <div class="summary-card-title">Confidence</div>
                <div class="summary-card-value">{{ value_confidence }}%</div>
            </div>
        </div>

        {% if comps %}
        <h4 class="mt-20 mb-20">Comparable Sales</h4>
        <table class="comps-table">
            <tr>
                <th>Address</th>
                <th>Dist</th>
                <th>Beds/Baths</th>
                <th>Sq Ft</th>
                <th>Sold</th>
                <th>$/SqFt</th>
                <th>Date</th>
            </tr>
            {% for comp in comps %}
            <tr>
                <td>{{ comp.address }}</td>
                <td>{{ comp.distance }}</td>
                <td>{{ comp.beds }}/{{ comp.baths }}</td>
                <td>{{ comp.sqft }}</td>
                <td>{{ comp.sold_price }}</td>
                <td>{{ comp.price_sqft }}</td>
                <td>{{ comp.date }}</td>
            </tr>
            {% endfor %}
        </table>
        {% endif %}

        {% if rent_estimate %}
        <div class="info-box mt-20">
            <div class="info-box-title">Rental Estimate</div>
            <p>Estimated Monthly Rent: <strong>{{ rent_estimate }}</strong></p>
            <p>Gross Yield Range: {{ gross_yield }}</p>
        </div>
        {% endif %}
    </div>

    <!-- Neighborhood -->
    <div class="section">
        <div class="section-header">
            <div class="section-icon">7</div>
            <div class="section-title">Neighborhood Intelligence</div>
        </div>

        <div class="summary-grid">
            {% if schools %}
            <div class="summary-card">
                <div class="summary-card-title">Schools</div>
                <div style="font-size: 10pt;">{{ schools }}</div>
            </div>
            {% endif %}
            {% if transit %}
            <div class="summary-card">
                <div class="summary-card-title">Transit/Access</div>
                <div style="font-size: 10pt;">{{ transit }}</div>
            </div>
            {% endif %}
        </div>

        {% if flood_zone %}
        <div class="info-box {% if flood_zone != 'X' %}warning{% endif %} mt-20">
            <div class="info-box-title">FEMA Flood Zone</div>
            <p>Zone: <strong>{{ flood_zone }}</strong></p>
            {% if flood_zone != 'X' %}
            <p style="color: var(--warning);">Flood insurance may be required.</p>
            {% endif %}
        </div>
        {% endif %}

        {% if environmental_concerns %}
        <div class="info-box danger mt-20">
            <div class="info-box-title">Environmental Concerns</div>
            <ul>
                {% for concern in environmental_concerns %}
                <li>{{ concern }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
    </div>

    <div class="page-break"></div>

    <!-- Next Steps -->
    <div class="section">
        <div class="section-header">
            <div class="section-icon">8</div>
            <div class="section-title">Next Steps & Recommendations</div>
        </div>

        {% if top_questions %}
        <h4 class="mb-20">Top 10 Due Diligence Questions</h4>
        <ol>
            {% for question in top_questions %}
            <li style="margin-bottom: 8px;">{{ question }}</li>
            {% endfor %}
        </ol>
        {% endif %}

        {% if top_documents %}
        <h4 class="mt-20 mb-20">Documents to Request</h4>
        <ul class="checklist">
            {% for doc in top_documents %}
            <li>{{ doc }}</li>
            {% endfor %}
        </ul>
        {% endif %}

        {% if next_steps %}
        <h4 class="mt-20 mb-20">Action Items</h4>
        <ul class="checklist">
            {% for step in next_steps %}
            <li>{{ step }}</li>
            {% endfor %}
        </ul>
        {% endif %}
    </div>

    <!-- Disclaimer -->
    <div class="disclaimer">
        <strong>Disclaimer:</strong> This report is for informational purposes only and does not constitute legal, financial, or professional advice.
        All information should be independently verified. {{ brand_name }} makes no warranties regarding the accuracy or completeness of this information.
        Consult with qualified professionals before making any real estate decisions.
    </div>

    <div class="report-footer">
        <p>Generated by {{ brand_name }} | {{ report_date }}</p>
        <p style="margin-top: 5px; font-size: 8pt;">Confidential - For Authorized Use Only</p>
    </div>
</body>
</html>
